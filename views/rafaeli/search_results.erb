<style>
.bottom_link {
  height: 10px;
  display: inline-block;
  font-size: 13px;
  padding-bottom: 12px
}

.single_experience {
  cursor: pointer;
  padding: 10px;

}
.single_experience:hover {
  background-color:whitesmoke;
}
.title:hover {
  text-decoration: underline;
}
</style>
<div class='search_results_wrapper'>
<% if results.any? %>
  <% results = results[0..2] %>
  <% results.each do |res| %>
    <%  user_casts = $casts.all(user_id: res[:_id]) %>
    <div class='single_result'>
      <div class='left_half flex6'>
        <div class='top_row'>
          <span class='name'><%=res[:title]%></span>
          <% if res[:location].present? %>
          <span class='location' style='display: inline-block; margin-left: 10px'> › <%=res[:location].to_s %></span>
          <% end %><% if res[:rate].present? %><span class='location' style='display: inline-block; margin-left: 10px'> › <%=res[:rate].to_s %></span>            
          <% end %>    
        </div>
        <div class='title'>      
          <a href='<%=$root_url%><%=user_link(res)%>'>
            <% if res[:name].present? %><span class='title'><%=res[:name]%></span> <% end %>
          </a>
          
        </div>
        <div class='desc'>
          <%= res[:desc] %>          
        </div>

        <!-- LINKS -->
        <% use_bottom_links = true %>
        <% if use_bottom_links  %>
          <div class='bottom_links'>
            <% if res[:license_url].present? %>            
              <a class='bottom_link' href='<%=res[:license_url].to_s%>' target=_blank >📎 CV</a> ·
            <% end %>   

              <!-- <a class='bottom_link' href='#' zonclick='alert("Not implemented yet, will be done by 1 Sept");'> Chat </a> ·
              <a class='bottom_link' href='#' zonclick='alert("Not implemented yet, will be done by 1 Sept");'> Hire </a> · -->
              <% RAFA_NUM_LINKS.times do |i| %>
                <% link_name = res["links_name_"+i.to_s].to_s.downcase %>
                <% link_val  = res["links_val_"+i.to_s] %>
                <% if link_val.present? %>
                  <% is_email = link_name.include? 'email' %>
                  <a class='bottom_link' target=_blank 
                      <% if is_email %> href='mailto:<%=link_val%>'
                      <% else %> href='//<%=link_val%>' <% end %> 
                    >

                    <% if is_email %> 📩 <% end %>
                    <% if link_name.include? 'git' %>   <i class='fa fa-github'></i> <% end %>
                    <% if link_name.include? 'linkedin' %>  <i class='fa fa-linkedin'></i> <% end %>
                    <% if link_name.include? 'home' %>  <i class='fa fa-home'></i> <% end %>
                    
                    <%= link_name %>                
                  </a> 
                  <% if res["links_val_"+(i+1).to_s].present? %> <span class='separator-dot'> · </span> <% end %>
                  <% end %>
                <% end %>
              
              <!-- <a class='bottom_link' href='#' zonclick='alert("Not implemented yet, will be done by 1 Sept");'> Homepage </a> ·
              <a class='bottom_link' href='#' zonclick='alert("Not implemented yet, will be done by 1 Sept");'> foo@email.com </a>  -->
              <% if false && user_casts.any? %>
               <a class='bottom_link' style='font-weight: bold' href='#' onclick='$(this).closest(".single_result").find(".experiences_list").toggle(); return false'> Experience (<%= user_casts.count %>) </a> 
              <% end %>
          </div>
        <% end %>

        <!-- EXPERIENCE -->
        <% if user_casts.any? %> 
          <div class='experiences_list' style='padding-left:10px'>
          <div style='font-weight: bold; margin: 10px'> Experience </div>
          <% user_casts.to_a.each do |cast| %>
            <%= erb :'rafaeli/single_search_result_extra', locals: {cast: cast, search_val: search_val} %>
          <% end %>
          </div>        
        <% end %>

        <!-- EDUCATION -->
          <% shown_education_title = false %>
          <div class='education_list' style='padding-left:10px'>
          <% RAFA_NUM_EDU.times do |i| %>
            <%             
              title = res['edu_achievement_'+i.to_s]
              client_name = res['edu_institute_'+i.to_s]
              custom_time = res['edu_date_'+i.to_s]
              cast = {title: title, client_name: client_name, custom_time: custom_time}
            %>
            
            <% if title.present? %>
              <% if !shown_education_title %>              
                <div style='font-weight: bold; margin: 10px'> Education </div>
                <% shown_education_title = true %>
              <% end %>

              <%= erb :'rafaeli/single_search_result_extra', {locals: {cast: cast, search_val: search_val, emoji: '🏫'}} %>
              <% end %>
            <% end %>        
            </div>        
      </div>
      <% if true %>
      <div class='right_half img_container flex1' style='zborder:1px solid red; text-align: right'>
        <% if res[:img_url].present? && (!res[:img_url].to_s.include?('profile.png')) %>
        <img src='<%=res[:img_url]%>' />
        <% end %>
      </div>
      <% end %>      
    </div>
  <% end %>
      <div class=ct>
        <button>click to see more </button>
      </div>
<% else %>
  <div class='no_results ct'>
    <br/>
    <h5> 
      Oh, sorry. Nobody available for that right now. 
      <br/>
      <br/>
      We're still in alpha, launching early '23. 
      <br/>
      <br/>
      You can <a href='mailto:requests@rafaeli.io?subject=Request for talent'>write us</a> for specific requests.</a>
      <div>
    </h5>
  </div>
<% end %>
</div>

<script>

</script>